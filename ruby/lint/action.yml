name: 'Lint - rubocop'
description: 'Lints using rubcop'
inputs:
  SLACK_BOT_TOKEN:
    description: secret value
    required: true
  SLACK_CHANNEL:
    description: secret value
    required: true
  
runs:
  using: "composite"
  steps:
    - name: Setup
      uses: wishabi/github-actions/ruby/setup/@PDA-325-ruby
      with:
        SLACK_BOT_TOKEN: "${{inputs.SLACK_BOT_TOKEN }}"
        SLACK_CHANNEL: "${{inputs.SLACK_CHANNEL }}"
    - name: Execute rubocop
      continue-on-error: true
      shell: bash
      run: bundle exec rubocop --format progress --format json --out rubocop/rubocop.json
    - name: 'Upload rubocop results'
      uses: actions/upload-artifact@v3
      with:
        name: ${{ github.sha }}-rubocop-results
        path: ./rubocop/rubocop.json
        retention-days: 1
